/*
a = {
  "content": [{
    "id": "5a97c29c68f0550001e108f7",
    "metaData": {
      "status": "approved",
      "year": 2018,
      "company": "Medco",
      "createdBy": "operator_root",
      "createdAt": 1519895196027,
      "updatedAt": 1519895246252,
      "approvedBy": "mog_root",
      "processInstanceId": null,
      "originalFileName": "TemplateRESERVES-ANNUAL_REVIEW-150218Valid (1).xlsx",
      "originalFileId": "9432c2e5-bb90-474d-908c-e0dd083b8320",
      "block": "56"
    },
    "reserves": [{
      "name": "BLOCK SUMMARY",
      "field": null,
      "note": null,
      "data": [{
        "name": "P50 In Place Volume (HCIIP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 2}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 13
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 5}]
      }, {
        "name": "Ultimate Recovery (UR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 1}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 14
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Cumulative Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 2424}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "2P Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "2C Contingent Resources",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Prospective Resources",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Own Use (Consumed in Operations)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "P50 HYDROCARBONS INITIALLY IN PLACE",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Changes",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "2P RESERVES (PROVED & PROBABLE)",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 1}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 2
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 3}]
      }, {
        "name": "Revisions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Improved Recovery",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Discoveries & Extensions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reclassification - Transfer",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Ending Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Total Change",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reserve Replacement Ratio (RRR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 1}]
      }]
    }, {
      "name": "1P PROVEN RESERVES",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 1}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 1
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 4}]
      }, {
        "name": "Revisions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Improved Recovery",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Discoveries & Extensions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reclassification – Transfer",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Total Change",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "CONTINGENT RESOURCES",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 2}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Revisions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 2}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Improved Recovery",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Discoveries & Extensions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 5
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reclassification – Transfer",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Replacement Ratio (CRR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "PROSPECTIVE RESOURCES",
      "field": null,
      "note": "test test test \nRAR",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 6}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Changes",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 6}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 424}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "FURTHER RESOURCE DETAILS",
      "field": "Field 1",
      "note": "CiO and Prospective Resources are moved to first summary table",
      "data": [{
        "name": "In Place Volume (HCIIP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 1}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 1
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 1}]
      }, {
        "name": "Ultimate Recovery (UR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 2}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Cumulative Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 1}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 1
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 1}]
      }, {
        "name": "Proved Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved Developing Producing (PDP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 1}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved developing Non-producing (PDNP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved Undeveloped (PUD)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "2P Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 2}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 3
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Developed",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Undeveloped",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "3P Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Resources (C1)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Resources (C2)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Resources (C3)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "FURTHER RESOURCE DETAILS",
      "field": "Field 2",
      "note": "CiO and Prospective Resources are moved to first summary table field2",
      "data": [{
        "name": "In Place Volume (HCIIP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 242}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 67
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 13}]
      }, {
        "name": "Ultimate Recovery (UR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Cumulative Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 2}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 2
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved Developing Producing (PDP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 2
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved developing Non-producing (PDNP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved Undeveloped (PUD)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 2
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 2}]
      }, {
        "name": "2P Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Developed",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Undeveloped",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "3P Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Resources (C1)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Resources (C2)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Resources (C3)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }]
  }, {
    "id": "5aa115025888640001d3e1c0",
    "metaData": {
      "status": "approved",
      "year": 2017,
      "company": "Medco",
      "createdBy": "operator_root",
      "createdAt": 1520506114182,
      "updatedAt": 1520506157898,
      "approvedBy": "mog_root",
      "processInstanceId": null,
      "originalFileName": "template-reserve-annual.xlsx",
      "originalFileId": "5aa1135c5888640001d3e1be",
      "block": "88"
    },
    "reserves": [{
      "name": "BLOCK SUMMARY",
      "field": null,
      "note": null,
      "data": [{
        "name": "P50 In Place Volume (HCIIP)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 10}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 12
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Ultimate Recovery (UR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Cumulative Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Proved Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "2P Reserves",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "2C Contingent Resources",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Prospective Resources",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Own Use (Consumed in Operations)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "P50 HYDROCARBONS INITIALLY IN PLACE",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Changes",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "2P RESERVES (PROVED & PROBABLE)",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Revisions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Improved Recovery",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Discoveries & Extensions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reclassification - Transfer",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Ending Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Total Change",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reserve Replacement Ratio (RRR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "1P PROVEN RESERVES",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Revisions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Improved Recovery",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Discoveries & Extensions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reclassification – Transfer",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Production",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Total Change",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "CONTINGENT RESOURCES",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Revisions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Improved Recovery",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Discoveries & Extensions",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Reclassification – Transfer",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Contingent Replacement Ratio (CRR)",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }, {
      "name": "PROSPECTIVE RESOURCES",
      "field": null,
      "note": "\n",
      "data": [{
        "name": "Year Opening Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Changes",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }, {
        "name": "Year Closing Balance",
        "values": [{"hydrocarbon": "Oil", "unit": "MMstb", "value": 0}, {
          "hydrocarbon": "Condensate",
          "unit": "MMstb",
          "value": 0
        }, {"hydrocarbon": "Gas", "unit": "Bscf", "value": 0}]
      }]
    }]
  }],
  "totalElements": 2,
  "totalPages": 1,
  "last": true,
  "first": true,
  "numberOfElements": 2,
  "sort": null,
  "size": 20,
  "number": 0
}

 rowTemplate:
 {
    "company": "Daleel",
    "block": "5",
    "year": 2016,
    "reservesReportType": "Proven Reserves",
    "hydrocarbonType": "Oil",
    "item": "Opening Balance",
    "value": 300000,
    "unit": "MMstb"
  }
*/

import { flattenDeep, flatMap, keys, values } from 'lodash-es'
import { fixNbr } from 'libs/utils'

export function processReservesData (data) {
  const { content } = data
  return flattenDeep(
    content.map((report) => {
      const { metaData, data } = report
      return data.map((row) => {
        return (row.items || [])
          .map((d) => {
            if (d.name === 'Total Change') return null
            else {
              return d.values.map((v) => {
                return {
                  company: metaData.company,
                  block: metaData.block,
                  year: metaData.year,
                  field: row.field,
                  reservesReportType: row.category,
                  hydrocarbonType: v.hydrocarbon.toLowerCase(),
                  item:
                    (/Opening Balance/.test(d.name) && 'Opening Balance') ||
                    (/Closing Balance/.test(d.name) && 'Closing Balance') ||
                    d.name,
                  value: (d.name === 'Year Production'
                    ? (x) => -Math.abs(x)
                    : (x) => x)(Number(+v.value)),
                  unit: v.unit === 'Tsf' ? 'Tscf' : v.unit,
                }
              })
            }
          })
          .filter((i) => i)
      })
    }),
  )
}

const annualResTypes = [
  { contingentC1: 'C1 contingent' },
  { contingentC2: 'C2 contingent' },
  { contingentC3: 'C3 contingent' },
  { cumulativeProduction: 'Cumulative Production' },
  { eur: 'EUR' },
  { hciip: 'HCIIP' },
  { p1Developed: '1P Developed' },
  { p1Total: 'p1Total' },
  { p1Undeveloped: '1P Undeveloped' },
  { p2Developed: '2P Developed' },
  { p2Total: 'p2Total' },
  { p2Undeveloped: '2P Undeveloped' },
  { p3: '3P' },

  // front-end calc data
  { cr: 'CR' },
  { remainingHCIIP: 'Remaining HCIIP' },
]

export function processAnnualResData (data) {
  const f = fixNbr
  const { content } = data
  return flatMap(content, (c) => {
    const {
      data,
      metaData: { company, block, year, hydrocarbonType },
    } = c
    return flatMap(data, (d) => {
      const {
        cluster,
        field,
        group,
        formation,
        member,
        hciip,
        cumulativeProduction,
        p2Total,
        contingentC1,
        contingentC2,
      } = d
      const cr = f(contingentC1) + f(contingentC2)
      const remainingHCIIP =
        f(hciip) - (f(cumulativeProduction) + f(p2Total) + cr)
      // CONDENSATE OIL GAS
      const unit = hydrocarbonType === 'GAS' ? 'Tscf' : 'MMstb'

      return annualResTypes.map((item) => {
        const key = keys(item)[0]
        const type = values(item)[0]
        const base = {
          country: 'TOTAL',
          company,
          block,
          year,
          cluster,
          field,
          group,
          formation,
          member,
          hydrocarbonType,
          unit,
          type,
        }

        switch (key) {
          case 'cr':
            return {
              ...base,
              value: cr,
            }

          case 'remainingHCIIP':
            return {
              ...base,
              value: remainingHCIIP,
            }

          default:
            return {
              ...base,
              value: f(d[key]),
            }
        }
      })
    })
  })
}

const fyfRecordTypes = ['previousYear', 'currentYear', 'forecast']

export function processFYFData (data) {
  return flatMap(data.content, ({ data, metaData }) =>
    flatMap(data, (d) =>
      flatMap(fyfRecordTypes, (typeName) =>
        flatMap(
          Array.isArray(d[typeName]) ? d[typeName] : [d[typeName]],
          (item) => [
            {
              year: item.year,
              hydrocarbonType: d.hydrocarbon.toLowerCase(),
              company: metaData.company,
              block: metaData.block,
              reservesReportType: '1P PROVEN RESERVES',
              value: item.values['1P'],
              unit: d.unit,
              currentYear: `Submitted at ${metaData.year}`,
            },
            {
              year: item.year,
              hydrocarbonType: d.hydrocarbon.toLowerCase(),
              company: metaData.company,
              block: metaData.block,
              reservesReportType: '2P RESERVES (PROVED & PROBABLE)',
              value: item.values['2P'],
              unit: d.unit,
              currentYear: `Submitted at ${metaData.year}`,
            },
          ],
        ),
      ),
    ),
  )
}
